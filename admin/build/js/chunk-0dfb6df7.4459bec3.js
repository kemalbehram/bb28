(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0dfb6df7"],{"7a88":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Card",{attrs:{"dis-hover":""}},[s("table-header-new",{attrs:{title:"会员返水"}},[s("Date-picker",{staticClass:"ml-6",staticStyle:{width:"200px"},attrs:{value:t.value1,format:"yyyy-MM-dd",placeholder:"选择日期",type:"date"},on:{"on-change":t.handleChange}}),s("Button",{staticClass:"ml-6",attrs:{size:"small",type:"primary"},on:{click:t.onRebate}},[t._v("查询")]),s("Button",{staticClass:"ml-6",attrs:{size:"small",type:"success"},on:{click:t.onAllConfirm}},[t._v("全部反水")]),s("Button",{staticClass:"ml-40 agent",attrs:{size:"small",type:"success"},on:{click:function(e){return t.$store.dispatch("onRebateConfig")}}},[t._v("反水配置")])],1),s("lett-loading",{attrs:{visible:t.slect_loading},on:{click:t.hiddenLoading}}),s("i-table",{attrs:{columns:t.columns,data:t.list},scopedSlots:t._u([{key:"nickname",fn:function(e){var a=e.row;return[a.user_avatar?s("Avatar",{staticClass:"mr-10",attrs:{src:a.user_avatar,shape:"circle",size:"22"}}):t._e(),s("span",{staticClass:"mr-6 font-14"},[t._v(t._s(a.user_name))])]}},{key:"room1",fn:function(e){var a=e.row;return[s("span",[t._v(t._s(a.rebate_list.room1.profit))])]}},{key:"room1_profit",fn:function(e){var a=e.row;return[s("span",[t._v(t._s(a["bonus_room1"]))])]}},{key:"room3_profit",fn:function(e){var a=e.row;return[s("span",[t._v(t._s(a["bonus_room3"]))])]}},{key:"room3",fn:function(e){var a=e.row;return[s("span",[t._v(t._s(a.rebate_list.room3.profit))])]}},{key:"room4",fn:function(e){var a=e.row;return[s("span",[t._v(t._s(a.rebate_list.room4.profit))])]}},{key:"room5",fn:function(e){var a=e.row;return[s("span",[t._v(t._s(a.rebate_list.room5.profit))])]}},{key:"room6",fn:function(e){var a=e.row;return[s("span",[t._v(t._s(a.rebate_list.room6.profit))])]}},{key:"action",fn:function(e){var a=e.row;return[-1===t.rebated_users.indexOf(a.user_id)?s("i-button",{attrs:{size:"small",type:"success"},on:{click:function(e){return t.confirm(a.user_id,a.total_rebate)}}},[t._v("确认返水")]):s("i-button",{attrs:{size:"small",type:"info"}},[t._v("已返水")])]}}])}),s("br"),s("Card",{attrs:{"dis-hover":""}},[s("lett-loading",{attrs:{visible:t.loading},on:{click:t.hiddenLoading}}),s("Table",{attrs:{columns:t.bet_columns,data:t.bet_list,border:""},scopedSlots:t._u([{key:"nickname",fn:function(e){var a=e.row;return[a.user.avatar?s("Avatar",{staticClass:"mr-10",attrs:{src:a.user.avatar,shape:"circle",size:"22"}}):t._e(),s("span",{staticClass:"mr-6 font-14"},[t._v(t._s(a.user.nickname))])]}}])}),s("br"),s("Page",{attrs:{"page-size":t.pagesize,total:t.total},on:{"on-change":t.pageChange}})],1),s("rebate-config")],1)},i=[],n=(s("d81d"),s("0d03"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Drawer",{attrs:{closable:!1,title:"反水设置",width:"900"},on:{"on-visible-change":t.getData},model:{value:t.params.visible,callback:function(e){t.$set(t.params,"visible",e)},expression:"params.visible"}},[s("Card",{attrs:{"dis-hover":!0,shadow:!1}},[s("lett-loading",{attrs:{visible:t.loading},on:{click:t.hiddenLoading}}),s("div",{staticClass:"space-between",attrs:{slot:"title"},slot:"title"},[s("span",[t._v("普通用户")]),s("i-switch",{attrs:{size:"large"},model:{value:t.showClose,callback:function(e){t.showClose=e},expression:"showClose"}},[s("span",{attrs:{slot:"open"},slot:"open"},[t._v("显示")]),s("span",{attrs:{slot:"close"},slot:"close"},[t._v("关闭")])])],1),"{}"!=JSON.stringify(t.form_user)?s("Form",{staticClass:"relative pt-10",attrs:{"label-width":70,"label-position":"right"}},[t._l(t.form_user,(function(e,a){return t.checkShow(e.opend)?s("FormItem",{key:a,staticClass:"border-bottom pb-20",attrs:{label:"房间"+a.substr(a.length-1,1)}},[s("div",{staticClass:"display-flex mb-10"},[s("RadioGroup",{staticClass:"pr-20",model:{value:e.opend,callback:function(s){t.$set(e,"opend",s)},expression:"item.opend"}},[s("Radio",{attrs:{label:"1",value:"1"}},[t._v("显示")]),s("Radio",{attrs:{label:"2",value:"2"}},[t._v("关闭")])],1),s("RadioGroup",{model:{value:e.model,callback:function(s){t.$set(e,"model",s)},expression:"item.model"}},[s("Radio",{attrs:{label:"1",value:"1"}},[t._v("流水模式")]),s("Radio",{attrs:{label:"2",value:"2"}},[t._v("亏损模式")])],1),s("RadioGroup",{staticStyle:{margin:"left:40px"},model:{value:e.limit,callback:function(s){t.$set(e,"limit",s)},expression:"item.limit"}},[s("Radio",{attrs:{label:"1",value:"1"}},[t._v("无限制（全部玩法都反水）")]),s("Radio",{attrs:{label:"2",value:"2"}},[t._v("组合反水")])],1)],1),t._l(e.items,(function(i,n){return s("div",{key:n,staticClass:"display-flex mb-20"},[s("Input",{staticClass:"pr-20",attrs:{type:"number"},model:{value:e.items[n].money,callback:function(s){t.$set(e.items[n],"money",s)},expression:"item.items[c_index].money"}},[s("span",{attrs:{slot:"prepend"},slot:"prepend"},[t._v("金额限制")])]),s("Input",{staticClass:"pr-20",attrs:{type:"number"},model:{value:e.items[n].count,callback:function(s){t.$set(e.items[n],"count",s)},expression:"item.items[c_index].count"}},[s("span",{attrs:{slot:"prepend"},slot:"prepend"},[t._v("期数")])]),s("Input",{staticClass:"pr-20",attrs:{type:"number"},model:{value:e.items[n].other,callback:function(s){t.$set(e.items[n],"other",s)},expression:"item.items[c_index].other"}},[s("span",{attrs:{slot:"prepend"},slot:"prepend"},[t._v("返水比列")])]),s("div",{staticClass:"width-50"},[s("i-switch",{staticClass:"pr-20",attrs:{size:"large"},model:{value:e.items[n].is_open,callback:function(s){t.$set(e.items[n],"is_open",s)},expression:"item.items[c_index].is_open"}},[s("span",{attrs:{slot:"open",value:"1"},slot:"open"},[t._v("开启")]),s("span",{attrs:{slot:"close",value:"2"},slot:"close"},[t._v("关闭")])])],1),s("Icon",{staticClass:"pointer",attrs:{size:"30",type:"ios-backspace-outline"},on:{click:function(e){return t.remove(a,n)}}})],1)})),s("div",{staticClass:"text-center"},[s("Button",{attrs:{icon:"md-add",type:"primary"},on:{click:function(e){return t.addCondition(a)}}},[t._v("添加条件")])],1)],2):t._e()})),s("FormItem",[s("Button",{staticClass:"mb-20",attrs:{long:"",type:"primary"},on:{click:function(e){return t.updateConfig(2)}}},[t._v("确认修改")])],1)],2):t._e()],1)],1)}),o=[],r=(s("a434"),{data:function(){return{params:this.$store.state.drawer.rebate_config,loading:!1,form_user:{},form_agent:{},showClose:!1}},methods:{remove:function(t,e){this.form_user[t].items.splice(e,1)},addCondition:function(t){this.form_user[t].items.push({count:null,money:null,other:null,is_open:"2"})},getData:function(t){var e=this,s="user-rebate/config";this.loading=!0,this.$get(s).then((function(t){if(200!==t.code)return e.loading=t.message;e.loading=!1,e.form_user=t.data.user_rebate,e.form_agent=t.data.agent_rebate}))},updateConfig:function(t){var e="user-rebate/update-config",s={};s.id=t,this.loading=!0,s.data=1==t?this.form_agent:this.form_user,this.$post(e,s).then((function(t){if(200!==t.code)return!1}))},checkShow:function(t){return 1==this.showClose||0==this.showClose&&1==t},hiddenLoading:function(){}}}),l=r,c=(s("bf77"),s("2877")),u=Object(c["a"])(l,n,o,!1,null,"69ed490c",null),d=u.exports,m={name:"memberRebate",components:{rebateConfig:d},data:function(){return{value1:"",columns:[{title:"用户ID",key:"user_id"},{title:"昵称",slot:"nickname",fixed:"left",width:150},{title:"下注期数",key:"total_count"},{title:"总流水",key:"total_amount"},{title:"(总)负盈利",key:"total_profit"},{title:"房间1-负盈利",slot:"room1_profit"},{title:"房间3-负盈利",slot:"room3_profit"},{title:"总返利",key:"total_rebate"},{title:"房间一",slot:"room1"},{title:"房间三",slot:"room3"},{title:"房间四(未使用)",slot:"room4"},{title:"房间五",slot:"room5"},{title:"房间六(未使用)",slot:"room6"},{title:"操作",slot:"action"}],list:[],bet_list:[],bet_columns:[{title:"用户ID",key:"user_id"},{title:"昵称",slot:"nickname"},{title:"日期",key:"date"},{title:"反水金额",key:"profit"}],page:1,pagesize:20,total:0,rebated_users:[],loading:!1,slect_loading:!1,rebate_config:{}}},created:function(){var t=new Date;t.setTime(t.getTime()-864e5);var e=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate();this.value1=e,this.getConfig(),console.log(this.loading)},methods:{handleChange:function(t){this.value1=t,console.log(this.value1)},getConfig:function(){var t=this;this.$get("/user-rebate/config").then((function(e){t.rebate_config=e.data}))},onRebate:function(){var t=this,e={date:this.value1};if(""==this.value1)return this.$Message.warning("请选择日期");this.slect_loading=!0,this.$get("/user-rebate/index",e).then((function(e){if(t.list=[],t.slect_loading=!1,void 0===e.data)return t.$Message.warning("今日暂无投注记录");t.list=e.data})),this.getRebateList()},getRebateList:function(){var t=this,e={page:this.page,date:this.value1};this.loading=!0,this.$get("user-rebate/rebatelist",e).then((function(e){t.bet_list=[],t.rebated_users=[],t.bet_list=e.data.items,t.bet_list.length>0&&t.bet_list.map((function(e){t.rebated_users.push(e.user_id)})),t.total=e.data.page.total,t.loading=!1}))},pageChange:function(t){this.page=t,this.getRebateList()},confirm:function(t,e){var s=this;if(this.loading=!0,""==this.value1)return this.$Message.warning("请选择日期");this.$Modal.confirm({title:"确认反水",onOk:function(){var a={amount:e,user_id:t,date:s.value1};s.$post("/user-rebate/confirm",a).then((function(t){console.log("111")})),s.getRebateList(),s.loading=!1},onCancel:function(){s.loading=!1}})},onAllConfirm:function(){var t=this;return""==this.value1?this.$Message.warning("请选择日期"):0==this.list.length?this.$Message.warning("暂无反水用户"):(this.loading=!0,void this.$Modal.confirm({title:"确认全部反水吗",onOk:function(){var e={data:t.list,date:t.value1};t.$post("/user-rebate/allconfirm",e).then((function(t){})),t.getRebateList()},onCancel:function(){t.loading=!1}}))},hiddenLoading:function(){}}},p=m,f=Object(c["a"])(p,a,i,!1,null,null,null);e["default"]=f.exports},bf77:function(t,e,s){"use strict";var a=s("db97"),i=s.n(a);i.a},db97:function(t,e,s){}}]);